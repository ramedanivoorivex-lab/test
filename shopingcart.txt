    public IActionResult AddToCart(int id)
    {
        var product = _mydb.Products.Where(row => row.Id == id).FirstOrDefault();

        if (product == null) {
            return NotFound();
        }

        var cart = GetCart();

        // جلوگیری از آیتم تکراری
        if (!cart.Contains(product.Id))
        {
            cart.Add(product.Id);
        }

        SaveCart(cart);
        return RedirectToAction("Products");
    }

    public IActionResult Cart()
    {
        var ids = GetCart();
        var products = _mydb.Products.Where(row => ids.Contains(row.Id)).ToList();
        return View(products);
    }


	private List<int> GetCart()
    {
        var cartData = HttpContext.Session.GetString("Cart");
        if (string.IsNullOrEmpty(cartData)) { 
            return new List<int>();
        }
        return cartData.Split(',').Select(int.Parse).ToList();
    }

       private void SaveCart(List<int> cart)
       {
           var cartData = string.Join(",", cart);
           HttpContext.Session.SetString("Cart", cartData);
       }
